Refactored access rigths internal logic.
Should not have any visible changes.
